@page "/profile"
@inject HRSystem.UI.Services.UserService UserService
@inject HRSystem.UI.Services.AuthService AuthService
@inject NavigationManager Navigation

<h3>User Profile</h3>
@if (user == null)
{
    <div>Loading...</div>
}
else
{
    <div class="card shadow mt-4">
        <div class="card-header bg-primary text-white">
            <h4>@user.Fullname</h4>
        </div>
        <div class="card-body">
            <dl class="row">
                <dt class="col-sm-3">Email</dt>
                <dd class="col-sm-9">@user.Email</dd>
                <dt class="col-sm-3">Phone</dt>
                <dd class="col-sm-9">@user.PhoneNumber</dd>
                <dt class="col-sm-3">User Type</dt>
                <dd class="col-sm-9">@user.UserType</dd>
                <dt class="col-sm-3">Access Level</dt>
                <dd class="col-sm-9">@user.AccessLevel</dd>
                <dt class="col-sm-3">Specialty</dt>
                <dd class="col-sm-9">@user.Specialty</dd>
            </dl>
        </div>
    </div>
}

@code {
    private HRSystem.UI.DTOs.UserDto user;

    protected override async Task OnInitializedAsync()
    {
        var userId = await AuthService.GetCurrentUserIdAsync();
        if (userId != Guid.Empty)
        {
            @* user = await UserService.GetByIdAsync(userId.Value); // Only if userId is not null

            // Or, safer: *@
            user = await UserService.GetByIdAsync(userId ?? Guid.Empty);
        }
        else
        {
            Navigation.NavigateTo("/login");
        }
    }
}
